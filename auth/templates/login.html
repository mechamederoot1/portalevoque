<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Evoque Fitness</title>
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <style>
    :root {
      --primary-color: #FF6200;
      --secondary-color: #1C2526;
      --accent-color: #FF914D;
      --dark-color: #2A2F30;
      --light-color: #F8F9FA;
      --text-color: #212529;
      --scale-factor: 0.85;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--light-color);
      padding: calc(15px * var(--scale-factor));
    }
    
    .login-container {
      width: 100%;
      max-width: calc(450px * var(--scale-factor));
      padding: calc(15px * var(--scale-factor));
      transform: scale(var(--scale-factor));
      transform-origin: center;
    }
    
    .card {
      background-color: var(--dark-color);
      border: none;
      border-radius: calc(12px * var(--scale-factor));
      box-shadow: 0 calc(5px * var(--scale-factor)) calc(15px * var(--scale-factor)) rgba(0, 0, 0, 0.2);
      overflow: hidden;
      width: 100%;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: calc(5px * var(--scale-factor));
      background-color: var(--primary-color);
    }
    
    .card-body {
      padding: calc(2rem * var(--scale-factor));
      color: var(--light-color);
    }
    
    .logo {
      max-height: calc(70px * var(--scale-factor));
      margin-bottom: calc(1.2rem * var(--scale-factor));
      width: auto;
    }
    
    h3, h4 {
      color: var(--light-color);
      font-weight: 600;
      font-size: calc(1.25rem * var(--scale-factor));
    }
    
    .form-label {
      color: rgba(255, 255, 255, 0.95);
      font-weight: 500;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .input-group-text {
      background-color: rgba(255, 255, 255, 0.1);
      border: calc(1px * var(--scale-factor)) solid rgba(255, 255, 255, 0.2);
      color: var(--accent-color);
      font-size: calc(1rem * var(--scale-factor));
      padding: calc(0.375rem * var(--scale-factor)) calc(0.75rem * var(--scale-factor));
    }
    
    .form-control {
      background-color: rgba(255, 255, 255, 0.1);
      border: calc(1px * var(--scale-factor)) solid rgba(255, 255, 255, 0.2);
      color: var(--light-color);
      padding: calc(0.75rem * var(--scale-factor));
      font-size: calc(1rem * var(--scale-factor));
      height: calc(2.5rem * var(--scale-factor));
    }
    
    .form-control::placeholder {
      color: rgba(255, 255, 255, 0.6) !important;
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .form-control:focus {
      background-color: rgba(255, 255, 255, 0.15);
      border-color: var(--primary-color);
      box-shadow: 0 0 0 calc(0.25rem * var(--scale-factor)) rgba(255, 98, 0, 0.25);
      color: var(--light-color);
    }
    
    .btn {
      font-size: calc(1rem * var(--scale-factor));
      padding: calc(0.75rem * var(--scale-factor));
      border-radius: calc(30px * var(--scale-factor));
      line-height: 1.5;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      border: none;
      font-weight: 600;
      box-shadow: 0 calc(4px * var(--scale-factor)) calc(15px * var(--scale-factor)) rgba(255, 98, 0, 0.4);
    }
    
    .btn-primary:hover {
      background-color: white;
      color: var(--primary-color);
      transform: translateY(calc(-3px * var(--scale-factor)));
      box-shadow: 0 calc(6px * var(--scale-factor)) calc(20px * var(--scale-factor)) rgba(255, 98, 0, 0.6);
    }
    
    .btn-outline-secondary {
      background-color: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.2);
      color: var(--light-color);
    }
    
    .btn-outline-secondary:hover {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      color: white;
    }
    
    .form-check-input {
      width: calc(1.2em * var(--scale-factor));
      height: calc(1.2em * var(--scale-factor));
    }
    
    .form-check-label {
      color: rgba(255, 255, 255, 0.95);
      font-size: calc(1rem * var(--scale-factor));
    }
    
    .alert {
      border-radius: calc(8px * var(--scale-factor));
      font-size: calc(1rem * var(--scale-factor));
      padding: calc(0.75rem * var(--scale-factor)) calc(1.25rem * var(--scale-factor));
      /* Correção: Melhor contraste para mensagens */
      background-color: rgba(255, 255, 255, 0.15) !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
      color: white !important;
    }
    
    .alert-success {
      background-color: rgba(40, 167, 69, 0.2) !important;
      border: 1px solid rgba(40, 167, 69, 0.3) !important;
      color: #d4edda !important;
    }
    
    .alert-danger {
      background-color: rgba(220, 53, 69, 0.2) !important;
      border: 1px solid rgba(220, 53, 69, 0.3) !important;
      color: #f8d7da !important;
    }
    
    .additional-text {
      color: rgba(255, 255, 255, 0.8);
      text-align: center;
      margin-top: calc(1.5rem * var(--scale-factor));
      font-size: calc(0.9rem * var(--scale-factor));
    }
    
    .btn-close {
      width: calc(1em * var(--scale-factor));
      height: calc(1em * var(--scale-factor));
      filter: invert(1) !important; /* Ícone branco para melhor contraste */
    }
  </style>
</head>
<body>
  <div class="login-container">
    <div class="card animate__animated animate__fadeInUp">
      <div class="card-body">
        <!-- Logo -->
        <div class="text-center mb-4">
          <img src="https://images.totalpass.com/public/1280x720/czM6Ly90cC1pbWFnZS1hZG1pbi1wcm9kL2d5bXMvNHVrOWtkOGd3M2xlMXg4OGNzdzViN2NhdmUzY2hhNWV3Y2lyd2pyNmI4djl6aXdiNTV2YXg3bjJ2aDI2" 
               alt="Evoque Fitness Logo" 
               class="img-fluid logo">
          <h3 class="h4 mb-3">Painel administrativo</h3>
        </div>

        <!-- Mensagens Flash -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <!-- Formulário de Login ou Alteração de Senha -->
        {% if alterar_senha %}
          <form method="POST" action="{{ url_for('auth.first_login') }}">
            <h4 class="mb-4 text-center">Alteração de senha obrigatória</h4>
            <input type="hidden" name="usuario" value="{{ usuario }}">

            <div class="mb-3">
              <label for="nova_senha" class="form-label">Nova senha</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" class="form-control" id="nova_senha" name="nova_senha" required>
                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('nova_senha', this)">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>

            <div class="mb-4">
              <label for="confirmar_senha" class="form-label">Confirmar nova senha</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" class="form-control" id="confirmar_senha" name="confirmar_senha" required>
                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('confirmar_senha', this)">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>

            <button type="submit" class="btn btn-primary w-100 py-2">
              <i class="fas fa-save me-2"></i> Salvar nova senha
            </button>
          </form>
        {% else %}
          <form method="POST" action="{{ url_for('auth.login') }}">
            <div class="mb-3">
              <label for="usuario" class="form-label">Usuário</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-user"></i></span>
                <input type="text" class="form-control" id="usuario" name="usuario" placeholder="Digite seu usuário" required>
              </div>
            </div>

            <div class="mb-4">
              <label for="senha" class="form-label">Senha</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" class="form-control" id="senha" name="senha" placeholder="Digite sua senha" required>
                <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('senha', this)">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-4">
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="lembrar" name="lembrar">
                <label class="form-check-label" for="lembrar">
                  Lembrar-me
                </label>
              </div>
            </div>

            <button type="submit" class="btn btn-primary w-100 py-2">
              <i class="fas fa-sign-in-alt me-2"></i> Entrar
            </button>
          </form>
          
          <div class="additional-text">
            <p>Para suporte técnico, contate: ti@academiaevoque.com.br</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <script>
    function togglePassword(inputId, button) {
      const input = document.getElementById(inputId);
      const icon = button.querySelector('i');
      
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.replace('fa-eye', 'fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.replace('fa-eye-slash', 'fa-eye');
      }
    }
    
    // Ajuste adicional para garantir centralização em telas muito altas
    window.addEventListener('resize', function() {
      const bodyHeight = document.body.clientHeight;
      const windowHeight = window.innerHeight;
      
      if (bodyHeight < windowHeight) {
        document.body.style.alignItems = 'center';
      } else {
        document.body.style.alignItems = 'flex-start';
      }
    });
    
    // Disparar o evento de resize ao carregar a página
    window.dispatchEvent(new Event('resize'));
  </script>
</body>
</html>